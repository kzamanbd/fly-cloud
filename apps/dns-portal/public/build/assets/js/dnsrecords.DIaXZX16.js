import{r as l,W as T,j as e,Y as q}from"../app-DvdsmSzy.js";import{A as M,B as N}from"./authenticated-layout.BPQPPMU5.js";import{G as F,B as _,I as z,C as P,d as v,a as B,H}from"./index.1DXFiMoA.js";import{I as h}from"./input-error.BcDujnQs.js";import"./application-logo.CXTwUa3u.js";import"./transition.B4LWFviQ.js";function Z(c){return F({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M13.917 7A6.002 6.002 0 0 0 2.083 7H1.071a7.002 7.002 0 0 1 13.858 0h-1.012z"},child:[]}]})(c)}const Y=({auth:c,zones:o})=>{const[p,b]=l.useState([]),[w,g]=l.useState(!1),{data:a,setData:t,post:f,processing:n,reset:k,errors:i}=T({name:"",type:"",content:"",proxied:!0,ttl:1}),[d,S]=l.useState(0),[A,j]=l.useState(!0),C=new URLSearchParams(window.location.search),[r,y]=l.useState(C.get("zoneId")||"");o?.length&&!r&&y(o[0]?.id);const I=["A","AAAA","CNAME","TXT"],R=[{value:"1",label:"Auto"},{value:"120",label:"2 minutes"},{value:"300",label:"5 minutes"},{value:"600",label:"10 minutes"},{value:"900",label:"15 minutes"},{value:"1800",label:"30 minutes"},{value:"3600",label:"1 hour"}],L=async()=>{try{if(!r){N.error("Zone ID is required.");return}j(!0);const s=await window.axios.get(route("dns.records",r));b(s.data.result||[])}catch(s){console.error(s)}finally{j(!1)}};l.useEffect(()=>{r&&L()},[r]);const D=s=>{if(s.preventDefault(),!r){N.error("Zone ID is required.");return}if(d)return f(route("dns.update",[r,d]),{preserveScroll:!0,onSuccess:()=>{m();const x=p.map(u=>u.id===d?{...u,...a}:u);b(x)}});f(route("dns.store",r),{preserveScroll:!0,onSuccess:()=>m()})},E=async s=>{S(s.id),t(x=>({...x,name:s.name,type:s.type,content:s.content,proxied:s.proxied,ttl:s.ttl})),g(!0)},m=()=>{g(s=>!s),k()};return e.jsxs(M,{user:c.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"DNS Records"}),e.jsx("p",{children:"Manage DNS records of your domain."})]}),e.jsxs(_,{className:"ms-4",onClick:m,disabled:n,children:[e.jsx(z,{className:"size-5"}),"Add DNS Record"]})]}),children:[e.jsx(q,{title:"DNS Records"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white shadow-sm overflow-hidden rounded-lg",children:[w&&e.jsxs("form",{onSubmit:D,className:"space-y-5 px-6 py-3 border-b",children:[e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"[name] points to [IPv4 address] and has its traffic proxied through Cloudflare."}),e.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",children:"Type"}),e.jsxs("select",{className:"form-select",onChange:s=>{t("type",s.target.value)},value:a.type,required:!0,children:[e.jsx("option",{hidden:!0,children:"Type"}),I.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx(h,{message:i.type,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",children:"Name (required)"}),e.jsx("input",{id:"name",placeholder:"Enter name",className:"form-input",value:a.name,onChange:s=>t("name",s.target.value),required:!0}),e.jsx(h,{message:i.name,className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{htmlFor:"content",children:"IPv4 address (required)"}),e.jsx("div",{className:"flex",children:e.jsx("input",{id:"content",placeholder:"Content",value:a.content,onChange:s=>t("content",s.target.value),className:"form-input",required:!0})}),e.jsx(h,{message:i.content,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col justify-around items-center",children:[e.jsx("label",{htmlFor:"proxied",children:"Proxy Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"relative h-6 w-12 m-0",children:[e.jsx("input",{onChange:s=>{t("proxied",s.target.checked)},checked:a.proxied,type:"checkbox",className:"custom_switch peer absolute z-10 h-full w-full cursor-pointer opacity-0",id:"custom_switch_checkbox2"}),e.jsx("span",{className:"outline_checkbox bg-icon dark:border-white-dark dark:before:bg-white-dark block h-full rounded-full border-2 border-[#ebedf2] before:absolute before:bottom-1 before:left-1 before:h-4 before:w-4 before:rounded-full before:bg-[#ebedf2] before-bg-close before:bg-center before:bg-no-repeat before:transition-all before:duration-300 peer-checked:border-primary peer-checked:before:left-7 peer-checked:before:bg-primary peer-checked-before-bg"})]}),e.jsx("span",{children:a.proxied?"Proxied":"DNS Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"TTL"}),e.jsxs("div",{className:"flex",children:[e.jsxs("select",{disabled:a.proxied,className:"form-select rounded-r-none",value:a.ttl,onChange:s=>{t("ttl",Number(s.target.value))},children:[e.jsx("option",{hidden:!0,children:"Auto"}),R.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx("button",{type:"submit",disabled:n,className:"flex items-center justify-center rounded-r-md border border-l-0 border-[#e0e6ed] bg-[#eee] px-3 font-semibold dark:border-[#17263c] dark:bg-[#1b2e4b]",children:n?e.jsx(Z,{className:"size-5 animate-spin"}):d?"Update":"Add"})]})]})]})]}),e.jsxs("div",{className:"relative px-6 py-3 flex flex-column sm:flex-row flex-wrap space-y-4 sm:space-y-0 items-center justify-between",children:[e.jsx("div",{children:e.jsx("form",{className:"w-auto min-w-64 mx-auto",children:e.jsxs("select",{onChange:s=>y(s.target.value),className:"form-select",value:r,children:[e.jsx("option",{hidden:!0,children:"Select Zone"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})}),e.jsx("label",{htmlFor:"table-search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 rtl:inset-r-0 rtl:right-0 flex items-center ps-3 pointer-events-none",children:e.jsx(P,{className:"size-5 text-gray-400"})}),e.jsx("input",{type:"text",id:"table-search",className:"block p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Search for items"})]})]}),e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Content"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Created At"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Modified At"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),A?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{className:"px-6 py-4",colSpan:5,children:e.jsxs("div",{role:"status",className:"max-w-sm animate-pulse",children:[e.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-48 mb-4"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px] mb-2.5"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-2.5"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[330px] mb-2.5"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[300px] mb-2.5"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px]"}),e.jsx("span",{className:"sr-only",children:"Loading..."})]})})})}):e.jsx("tbody",{className:"max-h-[calc(100vh-370px)] overflow-y-auto",children:p.map(s=>e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:s.name}),e.jsx("td",{className:"px-6 py-4",children:s.type}),e.jsx("td",{className:"px-6 py-4",children:s.content}),e.jsx("td",{className:"px-6 py-4",children:v(s.created_on).format("LLL")}),e.jsx("td",{className:"px-6 py-4",children:v(s.modified_on).format("LLL")}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:E.bind(null,s),children:e.jsx(B,{className:"size-5"})}),e.jsx(H,{className:"size-5 cursor-pointer"})]})})]},s.id))})]})]})})})]})};export{Y as default};
